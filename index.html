<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scan Wagon</title>

<script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>

<style>
body {
    font-family: Arial;
    padding: 20px;
}

input {
    padding: 10px;
    width: 100%;
    margin-bottom: 15px;
    font-size: 16px;
}

button {
    padding: 12px;
    font-size: 16px;
    background: #2563eb;
    color: white;
    border: none;
    width: 100%;
    border-radius: 6px;
}

#reader {
    margin-top: 20px;
}

#result {
    margin-top: 20px;
    padding: 10px;
    background: #f3f3f3;
}
</style>
</head>

<body>

<h2>Enregistrement Wagon</h2>

<label>Numéro de wagon :</label>
<input type="text" id="wagonNumber" placeholder="Ex: 458796">

<button onclick="startScanner()">Scanner QR Code</button>

<div id="reader"></div>

<div id="result"></div>

<script>

let html5QrCode;

function startScanner() {

    html5QrCode = new Html5Qrcode("reader");

    html5QrCode.start(
        { facingMode: "environment" },
        { fps: 10, qrbox: 250 },
        (decodedText) => {

            document.getElementById("result").innerHTML =
                "<strong>QR détecté :</strong><br>" + decodedText +
                "<br><br><strong>Wagon :</strong> " +
                document.getElementById("wagonNumber").value;

            html5QrCode.stop();
        }
    ).catch(err => alert("Erreur caméra : " + err));
}

</script>

</body>
</html>
